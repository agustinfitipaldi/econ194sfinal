<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Analysis Report">
<meta name="dcterms.date" content="2025-06-09">

<title>State Banking Performance Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="arizona_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="arizona_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="arizona_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="arizona_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="arizona_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="arizona_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="arizona_analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="arizona_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="arizona_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="arizona_analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="arizona_analysis_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="arizona_analysis_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="arizona_analysis_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="arizona_analysis_files/libs/datatables-binding-0.33/datatables.js"></script>
<script src="arizona_analysis_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="arizona_analysis_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="arizona_analysis_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="arizona_analysis_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="arizona_analysis_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="arizona_analysis_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#data-loading-and-preparation" id="toc-data-loading-and-preparation" class="nav-link" data-scroll-target="#data-loading-and-preparation">Data Loading and Preparation</a></li>
  <li><a href="#percentile-calculation-function" id="toc-percentile-calculation-function" class="nav-link" data-scroll-target="#percentile-calculation-function">Percentile Calculation Function</a></li>
  <li><a href="#key-variables-analysis" id="toc-key-variables-analysis" class="nav-link" data-scroll-target="#key-variables-analysis">Key Variables Analysis</a></li>
  <li><a href="#interactive-line-charts" id="toc-interactive-line-charts" class="nav-link" data-scroll-target="#interactive-line-charts">Interactive Line Charts</a></li>
  <li><a href="#comprehensive-variable-analysis" id="toc-comprehensive-variable-analysis" class="nav-link" data-scroll-target="#comprehensive-variable-analysis">Comprehensive Variable Analysis</a></li>
  <li><a href="#performance-trends-by-category" id="toc-performance-trends-by-category" class="nav-link" data-scroll-target="#performance-trends-by-category">Performance Trends by Category</a></li>
  <li><a href="#key-findings-summary" id="toc-key-findings-summary" class="nav-link" data-scroll-target="#key-findings-summary">Key Findings Summary</a></li>
  <li><a href="#data-table-complete-results" id="toc-data-table-complete-results" class="nav-link" data-scroll-target="#data-table-complete-results">Data Table: Complete Results</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">State Banking Performance Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Analysis Report </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 9, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This analysis examines Arizona’s banking performance relative to other states across multiple quarters from 2019 to 2023. We calculate Arizona’s percentile ranking for each banking variable to understand how Arizona banks perform compared to the national distribution.</p>
</section>
<section id="data-loading-and-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-loading-and-preparation">Data Loading and Preparation</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the combined FDIC data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"combined_fdic_data.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean column names by removing special characters and spaces</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>clean_names <span class="ot">&lt;-</span> <span class="cf">function</span>(names) {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  names <span class="sc">%&gt;%</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"[^A-Za-z0-9_]"</span>, <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"__+"</span>, <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_remove</span>(<span class="st">"^_+|_+$"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data) <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(<span class="fu">names</span>(data))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert all columns except Obs, State, Date to numeric</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># First identify which columns should be numeric (all except the first 3)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>cols_to_convert <span class="ot">&lt;-</span> <span class="fu">names</span>(data)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(data)]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to numeric, handling any parsing issues</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(col <span class="cf">in</span> cols_to_convert) {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove any commas, dollar signs, or other formatting</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  data[[col]] <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, data[[col]])</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  data[[col]] <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">$"</span>, <span class="st">""</span>, data[[col]])</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  data[[col]] <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"%"</span>, <span class="st">""</span>, data[[col]])</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to numeric, turning any non-numeric values to NA</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  data[[col]] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data[[col]])</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all numeric columns (excluding Obs, State, Date)</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Obs, <span class="sc">-</span>State, <span class="sc">-</span>Date) <span class="sc">%&gt;%</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for comparison state data</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>state_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> COMPARISON_STATE) <span class="sc">%&gt;%</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Number of quarters for"</span>, COMPARISON_STATE, <span class="st">":"</span>, <span class="fu">nrow</span>(state_data)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of quarters for Arizona : 24"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Date range:"</span>, <span class="fu">min</span>(state_data<span class="sc">$</span>Date), <span class="st">"to"</span>, <span class="fu">max</span>(state_data<span class="sc">$</span>Date)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Date range: 03/31/2019 to 12/31/2024"</code></pre>
</div>
</div>
</section>
<section id="percentile-calculation-function" class="level2">
<h2 class="anchored" data-anchor-id="percentile-calculation-function">Percentile Calculation Function</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate percentile rank for the comparison state in each quarter</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>calculate_percentiles <span class="ot">&lt;-</span> <span class="cf">function</span>(data, state_name) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if the state exists in the data</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>state_name <span class="sc">%in%</span> data<span class="sc">$</span>State) {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">Date =</span> <span class="fu">unique</span>(data<span class="sc">$</span>Date)))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get unique dates</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  dates <span class="ot">&lt;-</span> <span class="fu">unique</span>(data<span class="sc">$</span>Date)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize results dataframe</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  results_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For each date, calculate percentiles</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(date <span class="cf">in</span> dates) {</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    date_data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>Date <span class="sc">==</span> date, ]</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    state_row <span class="ot">&lt;-</span> date_data[date_data<span class="sc">$</span>State <span class="sc">==</span> state_name, ]</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(state_row) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate percentiles for each numeric variable</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>      percentiles <span class="ot">&lt;-</span> <span class="fu">sapply</span>(numeric_cols, <span class="cf">function</span>(col) {</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        state_value <span class="ot">&lt;-</span> state_row[[col]]</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        all_values <span class="ot">&lt;-</span> date_data[[col]]</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(state_value) <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(all_values)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Calculate percentile rank (0-100)</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>          percentile_rank <span class="ot">&lt;-</span> <span class="fu">sum</span>(all_values <span class="sc">&lt;=</span> state_value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(all_values)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(percentile_rank)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(<span class="cn">NA_real_</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create row with percentile results</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>      result_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date, <span class="fu">t</span>(percentiles))</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(result_row)[<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(numeric_cols, <span class="st">"_percentile"</span>)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>      results_list[[<span class="fu">length</span>(results_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> result_row</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine all results</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(results_list) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    percentile_results <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, results_list)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    percentile_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> dates)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(percentile_results)</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentiles for the comparison state</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>state_percentiles <span class="ot">&lt;-</span> <span class="fu">calculate_percentiles</span>(data, COMPARISON_STATE)</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Date to proper date format</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>state_percentiles<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(state_percentiles<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="key-variables-analysis" class="level2">
<h2 class="anchored" data-anchor-id="key-variables-analysis">Key Variables Analysis</h2>
<p>Let’s focus on the most important banking performance indicators:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>percentile_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(state_percentiles)[<span class="fu">grepl</span>(<span class="st">"_percentile$"</span>, <span class="fu">names</span>(state_percentiles))]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(percentile_cols) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use first few columns as fallback</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  key_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(state_percentiles)[<span class="dv">2</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">9</span>, <span class="fu">ncol</span>(state_percentiles))]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select key banking performance variables based on actual column names</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  key_vars <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find Return on Assets</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  roa_col <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Return.*Assets.*percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(roa_col) <span class="sc">&gt;</span> <span class="dv">0</span>) key_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(key_vars, roa_col[<span class="dv">1</span>])</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find Return on Equity  </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  roe_col <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Return.*Equity.*percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(roe_col) <span class="sc">&gt;</span> <span class="dv">0</span>) key_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(key_vars, roe_col[<span class="dv">1</span>])</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find Net Interest Margin</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  nim_col <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Net.*Interest.*Margin.*percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(nim_col) <span class="sc">&gt;</span> <span class="dv">0</span>) key_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(key_vars, nim_col[<span class="dv">1</span>])</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find Equity Capital to Total Assets</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  equity_col <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Equity.*Capital.*Total.*Assets.*percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(equity_col) <span class="sc">&gt;</span> <span class="dv">0</span>) key_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(key_vars, equity_col[<span class="dv">1</span>])</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find Noncurrent Loans</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  noncurrent_col <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Noncurrent.*Loans.*percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(noncurrent_col) <span class="sc">&gt;</span> <span class="dv">0</span>) key_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(key_vars, noncurrent_col[<span class="dv">1</span>])</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find Net Charge Offs</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  chargeoff_col <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Net.*Charge.*percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(chargeoff_col) <span class="sc">&gt;</span> <span class="dv">0</span>) key_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(key_vars, chargeoff_col[<span class="dv">1</span>])</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find Cost of Funding</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  cost_col <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Cost.*Funding.*percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(cost_col) <span class="sc">&gt;</span> <span class="dv">0</span>) key_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(key_vars, cost_col[<span class="dv">1</span>])</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find Leverage Ratio</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  leverage_col <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Leverage.*percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(leverage_col) <span class="sc">&gt;</span> <span class="dv">0</span>) key_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(key_vars, leverage_col[<span class="dv">1</span>])</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove any NA values and ensure we have valid column names</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  key_vars <span class="ot">&lt;-</span> key_vars[<span class="sc">!</span><span class="fu">is.na</span>(key_vars) <span class="sc">&amp;</span> key_vars <span class="sc">!=</span> <span class="st">""</span>]</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  key_vars <span class="ot">&lt;-</span> <span class="fu">unique</span>(key_vars)  <span class="co"># Remove duplicates</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If still no key vars found, just take first 8 percentile columns</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(key_vars) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(percentile_cols) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    key_vars <span class="ot">&lt;-</span> <span class="fu">head</span>(percentile_cols, <span class="fu">min</span>(<span class="dv">8</span>, <span class="fu">length</span>(percentile_cols)))</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that all key_vars actually exist in the dataframe</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(key_vars) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  key_vars <span class="ot">&lt;-</span> key_vars[key_vars <span class="sc">%in%</span> <span class="fu">names</span>(state_percentiles)]</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a long format dataset for plotting (only if we have key_vars)</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(key_vars) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>  state_long <span class="ot">&lt;-</span> state_percentiles <span class="sc">%&gt;%</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Date, <span class="fu">all_of</span>(key_vars)) <span class="sc">%&gt;%</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Date, <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Percentile"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable_Clean =</span> <span class="fu">str_remove</span>(Variable, <span class="st">"_percentile"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace_all</span>(<span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace_all</span>(<span class="st">"   "</span>, <span class="st">" - "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_to_title</span>()</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>  state_long <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> state_percentiles<span class="sc">$</span>Date, </span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Variable =</span> <span class="st">"No Data"</span>, </span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Percentile =</span> <span class="cn">NA</span>, </span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Variable_Clean =</span> <span class="st">"No Data Available"</span>)</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Display summary statistics (only if we have data)</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(key_vars) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(state_long) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.na</span>(state_long<span class="sc">$</span>Percentile))) {</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>  summary_stats <span class="ot">&lt;-</span> state_long <span class="sc">%&gt;%</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Percentile)) <span class="sc">%&gt;%</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Variable_Clean) <span class="sc">%&gt;%</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Percentile =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Percentile, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">Min_Percentile =</span> <span class="fu">round</span>(<span class="fu">min</span>(Percentile, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">Max_Percentile =</span> <span class="fu">round</span>(<span class="fu">max</span>(Percentile, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">Latest_Percentile =</span> <span class="fu">round</span>(<span class="fu">last</span>(Percentile[<span class="sc">!</span><span class="fu">is.na</span>(Percentile)]), <span class="dv">1</span>),</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(summary_stats, </span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="fu">paste</span>(COMPARISON_STATE, <span class="st">"Banking Performance Percentiles Summary"</span>),</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Mean"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>, <span class="st">"Latest"</span>))</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Arizona Banking Performance Percentiles Summary</caption>
<colgroup>
<col style="width: 77%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Latest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Community Bank Leverage Ratio Cblr Election Count All Institutions</td>
<td style="text-align: right;">32.0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cost Of Funding Earning Assets All Institutions</td>
<td style="text-align: right;">51.7</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">76</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Credit Loss Provision To Net Charge Offs All Institutions</td>
<td style="text-align: right;">56.6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">66</td>
</tr>
<tr class="even">
<td style="text-align: left;">Equity Capital To Total Assets All Institutions</td>
<td style="text-align: right;">15.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Net Interest Margin All Institutions</td>
<td style="text-align: right;">85.6</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">80</td>
</tr>
<tr class="even">
<td style="text-align: left;">Noncurrent Loans Leases To Total Loans Leases All Institutions</td>
<td style="text-align: right;">63.9</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">94</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pretax Return On Assets All Institutions</td>
<td style="text-align: right;">76.8</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="even">
<td style="text-align: left;">Return On Equity All Institutions</td>
<td style="text-align: right;">81.4</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">66</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="interactive-line-charts" class="level2">
<h2 class="anchored" data-anchor-id="interactive-line-charts">Interactive Line Charts</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create individual plots for each key variable (only if we have data)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(key_vars) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(var <span class="cf">in</span> key_vars) {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    var_clean <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(var, <span class="st">"_percentile"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_replace_all</span>(<span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_replace_all</span>(<span class="st">"   "</span>, <span class="st">" - "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_to_title</span>()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    plot_data <span class="ot">&lt;-</span> state_percentiles <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(Date, <span class="fu">all_of</span>(var)) <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">Percentile =</span> <span class="sc">!!</span>var) <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Percentile))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(plot_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(plot_data, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Percentile, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">name =</span> var_clean, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">3</span>), <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">layout</span>(</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="fu">paste</span>(COMPARISON_STATE, var_clean, <span class="st">"Percentile Over Time"</span>), </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">14</span>)),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Date"</span>),</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Percentile (0-100)"</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)),</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">hovermode =</span> <span class="st">'x unified'</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">showlegend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">shapes =</span> <span class="fu">list</span>(</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">list</span>(<span class="at">type =</span> <span class="st">"line"</span>,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x0 =</span> <span class="fu">min</span>(plot_data<span class="sc">$</span>Date), <span class="at">x1 =</span> <span class="fu">max</span>(plot_data<span class="sc">$</span>Date),</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y0 =</span> <span class="dv">50</span>, <span class="at">y1 =</span> <span class="dv">50</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                 <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>, <span class="at">width =</span> <span class="dv">2</span>))</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_annotations</span>(</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="fu">max</span>(plot_data<span class="sc">$</span>Date), <span class="at">y =</span> <span class="dv">10</span>,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">text =</span> <span class="st">"50th percentile (median)"</span>,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">showarrow =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>      plot_list[[var_clean]] <span class="ot">&lt;-</span> p</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display plots</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(plot_list) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(plot_list)) {</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(plot_list[[i]])</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="comprehensive-variable-analysis" class="level2">
<h2 class="anchored" data-anchor-id="comprehensive-variable-analysis">Comprehensive Variable Analysis</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the figure output filename with state name</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>state_clean <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(<span class="fu">tolower</span>(COMPARISON_STATE), <span class="st">" "</span>, <span class="st">"_"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">fig.path =</span> <span class="fu">paste0</span>(<span class="st">"figures/"</span>, state_clean, <span class="st">"_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap showing all variables over time</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>percentile_cols_all <span class="ot">&lt;-</span> <span class="fu">names</span>(state_percentiles)[<span class="fu">grepl</span>(<span class="st">"_percentile$"</span>, <span class="fu">names</span>(state_percentiles))]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(percentile_cols_all) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  all_percentiles_long <span class="ot">&lt;-</span> state_percentiles <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Date, <span class="fu">all_of</span>(percentile_cols_all)) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Date, <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Percentile"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable_Clean =</span> <span class="fu">str_remove</span>(Variable, <span class="st">"_percentile"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace_all</span>(<span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_wrap</span>(<span class="dv">40</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Percentile))</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(all_percentiles_long) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create quarter labels manually</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    quarter_labels <span class="ot">&lt;-</span> <span class="cf">function</span>(dates) {</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>      quarters <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">as.numeric</span>(<span class="fu">format</span>(dates, <span class="st">"%m"</span>)) <span class="sc">/</span> <span class="dv">3</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>      years <span class="ot">&lt;-</span> <span class="fu">format</span>(dates, <span class="st">"%Y"</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(years, <span class="st">"</span><span class="sc">\n</span><span class="st">Q"</span>, quarters)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create heatmap</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    heatmap_plot <span class="ot">&lt;-</span> all_percentiles_long <span class="sc">%&gt;%</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Variable_Clean, <span class="at">fill =</span> Percentile)) <span class="sc">+</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"green"</span>, </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>                           <span class="at">midpoint =</span> <span class="dv">50</span>, <span class="at">name =</span> <span class="st">"Percentile"</span>) <span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_date</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(all_percentiles_long<span class="sc">$</span>Date),</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> quarter_labels,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length.x =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>),</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">paste</span>(COMPARISON_STATE, <span class="st">"Banking Performance Percentiles Heatmap"</span>),</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"All Variables Across All Quarters (Red = Below Median, Green = Above Median)"</span>,</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Banking Variables"</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(heatmap_plot)</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="figures/arizona_heatmap-plot-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="performance-trends-by-category" class="level2">
<h2 class="anchored" data-anchor-id="performance-trends-by-category">Performance Trends by Category</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group variables by category for better analysis using actual column names</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>profitability_vars <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>capital_strength_vars <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>asset_quality_vars <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Find profitability variables</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>roa_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Return_on_Assets.*All_Institutions_percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>roe_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Return_on_Equity.*All_Institutions_percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>nim_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Net_Interest_Margin.*All_Institutions_percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>pretax_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Pretax_Return.*All_Institutions_percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>profitability_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(roa_cols, roe_cols, nim_cols, pretax_cols)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Find capital strength variables</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>equity_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Equity_Capital.*Total_Assets.*All_Institutions_percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>leverage_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Leverage.*Capital.*All_Institutions_percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>risk_capital_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Total_Risk.*Capital.*All_Institutions_percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>capital_strength_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(equity_cols, leverage_cols, risk_capital_cols)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Find asset quality variables</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>noncurrent_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Noncurrent.*Loans.*Total_Loans.*All_Institutions_percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>chargeoff_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Net_Charge.*Loans.*All_Institutions_percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>allowance_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Loss_Allowance.*Loans.*All_Institutions_percentile"</span>, percentile_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>asset_quality_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(noncurrent_cols, chargeoff_cols, allowance_cols)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove NA values and ensure we have variables</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>profitability_vars <span class="ot">&lt;-</span> profitability_vars[<span class="sc">!</span><span class="fu">is.na</span>(profitability_vars)]</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>capital_strength_vars <span class="ot">&lt;-</span> capital_strength_vars[<span class="sc">!</span><span class="fu">is.na</span>(capital_strength_vars)]</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>asset_quality_vars <span class="ot">&lt;-</span> asset_quality_vars[<span class="sc">!</span><span class="fu">is.na</span>(asset_quality_vars)]</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate category averages (only if we have variables in each category)</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>category_data <span class="ot">&lt;-</span> state_percentiles <span class="sc">%&gt;%</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Profitability =</span> <span class="cf">if</span>(<span class="fu">length</span>(profitability_vars) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">all_of</span>(profitability_vars)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="cf">else</span> <span class="cn">NA_real_</span>,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">Capital_Strength =</span> <span class="cf">if</span>(<span class="fu">length</span>(capital_strength_vars) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">all_of</span>(capital_strength_vars)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="cf">else</span> <span class="cn">NA_real_</span>,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">Asset_Quality =</span> <span class="cf">if</span>(<span class="fu">length</span>(asset_quality_vars) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="dv">100</span> <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">all_of</span>(asset_quality_vars)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="cf">else</span> <span class="cn">NA_real_</span>  <span class="co"># Invert for asset quality</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, Profitability, Capital_Strength, Asset_Quality) <span class="sc">%&gt;%</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Date, <span class="at">names_to =</span> <span class="st">"Category"</span>, <span class="at">values_to =</span> <span class="st">"Percentile"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Percentile))</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot category trends</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(category_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>  category_plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(category_data, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Percentile, <span class="at">color =</span> <span class="sc">~</span>Category,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>                          <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">3</span>), <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout</span>(</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(COMPARISON_STATE, <span class="st">"Banking Performance by Category"</span>),</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Date"</span>),</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Percentile (0-100)"</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)),</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">hovermode =</span> <span class="st">'x unified'</span>,</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">shapes =</span> <span class="fu">list</span>(</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">type =</span> <span class="st">"line"</span>,</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">x0 =</span> <span class="fu">min</span>(category_data<span class="sc">$</span>Date), <span class="at">x1 =</span> <span class="fu">max</span>(category_data<span class="sc">$</span>Date),</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>             <span class="at">y0 =</span> <span class="dv">50</span>, <span class="at">y1 =</span> <span class="dv">50</span>,</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>, <span class="at">width =</span> <span class="dv">1</span>))</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>  category_plot <span class="ot">&lt;-</span> <span class="fu">plotly_empty</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"No category data available for plotting"</span>)</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(category_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="key-findings-summary" class="level2">
<h2 class="anchored" data-anchor-id="key-findings-summary">Key Findings Summary</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate latest performance summary</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>latest_date <span class="ot">&lt;-</span> <span class="fu">max</span>(state_percentiles<span class="sc">$</span>Date, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>latest_performance <span class="ot">&lt;-</span> state_percentiles <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">==</span> latest_date) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"_percentile"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Percentile"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Percentile)) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable_Clean =</span> <span class="fu">str_remove</span>(Variable, <span class="st">"_percentile"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_replace_all</span>(<span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_to_title</span>(),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Performance =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>      Percentile <span class="sc">&gt;=</span> <span class="dv">75</span> <span class="sc">~</span> <span class="st">"Strong (Top 25%)"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>      Percentile <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"Above Average"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>      Percentile <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"Below Average"</span>, </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Weak (Bottom 25%)"</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Percentile))</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Display top and bottom performers</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"## Latest Performance Summary ("</span>, <span class="fu">format</span>(latest_date, <span class="st">"%B %Y"</span>), <span class="st">")</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>## Latest Performance Summary ( December 2024 )</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>top_performers <span class="ot">&lt;-</span> latest_performance <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>bottom_performers <span class="ot">&lt;-</span> latest_performance <span class="sc">%&gt;%</span> <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### Top 5 Performing Areas:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### Top 5 Performing Areas:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(top_performers)) {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(i, <span class="st">". "</span>, top_performers<span class="sc">$</span>Variable_Clean[i], <span class="st">": "</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(top_performers<span class="sc">$</span>Percentile[i], <span class="dv">1</span>), <span class="st">"th percentile ("</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>             top_performers<span class="sc">$</span>Performance[i], <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1. Percent Of Institutions With Earning Gains Assets Greater Than 1 Billion: 100th percentile (Strong (Top 25%))
2. Percent Of Unprofitable Institutions All Institutions: 100th percentile (Strong (Top 25%))
3. Percent Of Unprofitable Institutions Assets Less Than 1 Billion: 98th percentile (Strong (Top 25%))
4. Total Risk Based Capital Non Cblr Electors Assets Less Than 1 Billion: 95.9th percentile (Strong (Top 25%))
5. Noncurrent Loans Leases To Total Loans Leases All Institutions: 94th percentile (Strong (Top 25%))</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">### Bottom 5 Performing Areas:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
### Bottom 5 Performing Areas:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(bottom_performers)) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(i, <span class="st">". "</span>, bottom_performers<span class="sc">$</span>Variable_Clean[i], <span class="st">": "</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(bottom_performers<span class="sc">$</span>Percentile[i], <span class="dv">1</span>), <span class="st">"th percentile ("</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>             bottom_performers<span class="sc">$</span>Performance[i], <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1. Leverage Core Capital Ratio All Institutions: 4th percentile (Weak (Bottom 25%))
2. Reserve Coverage Ratio All Institutions: 4th percentile (Weak (Bottom 25%))
3. Reserve Coverage Ratio Assets Greater Than 1 Billion: 4th percentile (Weak (Bottom 25%))
4. Loss Allowance To Loans Leases All Institutions: 2th percentile (Weak (Bottom 25%))
5. Loss Allowance To Loans Leases Assets Greater Than 1 Billion: 2th percentile (Weak (Bottom 25%))</code></pre>
</div>
</div>
</section>
<section id="data-table-complete-results" class="level2">
<h2 class="anchored" data-anchor-id="data-table-complete-results">Data Table: Complete Results</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interactive data table</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>table_data <span class="ot">&lt;-</span> state_percentiles <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, <span class="fu">ends_with</span>(<span class="st">"_percentile"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">format</span>(Date, <span class="st">"%Y-%m-%d"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">str_remove</span>(.x, <span class="st">"_percentile"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">str_replace_all</span>(<span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">str_to_title</span>(), </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ends_with</span>(<span class="st">"_percentile"</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(table_data, </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">dom =</span> <span class="st">'Bfrtip'</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>          ),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="fu">paste</span>(COMPARISON_STATE, <span class="st">"Banking Performance Percentiles by Quarter"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatRound</span>(<span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(table_data), <span class="at">digits =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-e29d071d5b5ab20f92ef" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e29d071d5b5ab20f92ef">{"x":{"filter":"none","vertical":false,"caption":"<caption>Arizona Banking Performance Percentiles by Quarter<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["2019-03-31","2019-06-30","2019-09-30","2019-12-31","2020-03-31","2020-06-30","2020-09-30","2020-12-31","2021-03-31","2021-06-30","2021-09-30","2021-12-31","2022-03-31","2022-06-30","2022-09-30","2022-12-31","2023-03-31","2023-06-30","2023-09-30","2023-12-31","2024-03-31","2024-06-30","2024-09-30","2024-12-31"],[2,2,6,2,2,2,2,2,2,30,44,70,72,94,91.66666666666666,94,92,94,94,94,88,88,90,76],[10,4,10,4,20,12,6,8,14,28,8,4,28,2,4.166666666666666,4.081632653061225,2.040816326530612,4.081632653061225,4.081632653061225,2.040816326530612,2.040816326530612,6.122448979591836,2.040816326530612,4.081632653061225],[4.081632653061225,4.081632653061225,8.163265306122449,2.040816326530612,6,2,6,4,2,40,68,82,80,94,91.66666666666666,94,92,94,94,94,90,86,88,84],[100,98,100,100,14,16,14,14,14,14,18,16,20,22,25,24,22,22,22,20,20,18,18,18],[100,98,100,100,18,24,22,16,18,18,24,22,26,28,33.33333333333333,32,30,32,32,30,28,30,30,30],[100,97.95918367346938,100,100,30,30,26,28,28,28,28,28,26,28,31.25,30,24,24,24,28,26,24,24,24],[94,94,94,94,94,94,92,100,96,84,82,57.99999999999999,48,16,20.83333333333334,20,8,4,4,4,4,6,12,6],[98,98,96,100,100,98,98,94,94,96,94,92,90,98,95.83333333333334,86,90,86,84,80,98,100,94,86],[89.79591836734694,93.87755102040816,93.87755102040816,93.87755102040816,94,88,88,98,94,78,78,54,46,16,18.75,20,8,6,4,4,6,6,12,6],[24,22,20,18,18,14,14,14,14,32,36,36,56.00000000000001,70,91.66666666666666,92,92,92,90,90,78,76,76,76],[12,12,10,8,8,12,14,14,14,14,16,14,12,10,6.25,12,12,10,10,10,12,12,10,10],[28.57142857142857,28.57142857142857,22.44897959183674,26.53061224489796,22,14,14,14,22,38,42,42,66,74,89.58333333333334,90,92,92,88,88,76,76,76,76],[74,92,100,100,2,100,94,88,2,2,14,14,100,96,2.083333333333333,98,6,42,48,68,46,57.99999999999999,46,66],[52,96,98,2,94,82,2,2,8,16,6,100,26,28,22.91666666666666,14,16.3265306122449,10.20408163265306,6.122448979591836,8.163265306122449,24.48979591836735,34.69387755102041,61.22448979591837,73.46938775510205],[73.46938775510205,91.83673469387756,93.87755102040816,93.87755102040816,4,98,90,84,2,6,14,16,94,94,100,96,12,40,48,70,56.00000000000001,62,56.00000000000001,72],[24,26,26,28,30,32,32,32,36,38,42,46,46,48,47.91666666666667,48,48,48,48,48,52,52,52,52],[12,14,16,16,12,16,12,12,12,14,14,14,14,14,10.41666666666667,6,6,8,8,8,6,6,6,6],[36.73469387755102,36.73469387755102,38.77551020408163,40.81632653061224,44,44,48,52,54,56.00000000000001,56.00000000000001,57.99999999999999,57.99999999999999,60,60.41666666666666,57.99999999999999,60,57.99999999999999,57.99999999999999,57.99999999999999,57.99999999999999,60,60,60],[20,20,20,20,22,26,28,28,28,32,32,38,46,46,47.91666666666667,48,46,48,48,48,46,46,46,48],[10,12,14,14,10,14,8,8,8,8,10,10,10,10,10.41666666666667,8,8,8,8,8,6,6,6,6],[32.6530612244898,32.6530612244898,32.6530612244898,32.6530612244898,38,40,42,44,44,48,50,56.00000000000001,56.00000000000001,56.00000000000001,58.33333333333334,57.99999999999999,57.99999999999999,56.00000000000001,56.00000000000001,56.00000000000001,56.00000000000001,56.00000000000001,56.00000000000001,56.00000000000001],[28,22,20,28,16,10,8,6,2,8,8,16,18,16,18.75,20,18,26,26,24,10,6,4,8],[18,10,16,10,2,4,4,2,2,2,2,2,10,60,52.08333333333334,74,74,72,66,78,80,82,82,78],[28.57142857142857,26.53061224489796,26.53061224489796,34.69387755102041,24,26,18,16,6,16,12,26,22,18,16.66666666666666,26,18,32,32,26,14,8,8,6],[10,8,12,14,12,14,12,10,16,80,90,90,90,88,87.5,88,86,88,86,86,80,76,80,74],[24,22,24,20,18,8,8,8,8,8,8,8,8,8,8.333333333333332,8,8,8,8,8,8,8,12,12],[10.20408163265306,8.163265306122449,8.163265306122449,20.40816326530612,18,20,20,18,20,86,94,92,90,92,89.58333333333334,88,86,88,86,86,86,84,84,84],[40,30,34,30,20,20,16,14,12,32,50,44,42,30,22.91666666666666,28,22,24,22,22,22,22,20,20],[57.99999999999999,52,57.99999999999999,52,36,26,36,28,22,30,28,30,24,24,25,24,22,24,24,24,12,16,22,22],[30.61224489795918,24.48979591836735,28.57142857142857,28.57142857142857,18,20,16,12,14,26,38,36,32,30,25,30,20,26,22,22,22,18,20,20],[42,44,24,32,22,18,18,16,12,6,4,10,16,4,4.166666666666666,4,4,8,8,10,8,4,4,4],[16,12,16,16,4,2,2,2,2,2,2,2,20,54,62.5,82,80,78,76,86,86,82,84,82],[55.10204081632652,59.18367346938776,38.77551020408163,51.02040816326531,40,30,30,28,12,12,10,20,18,10,6.25,10,6,10,12,14,10,6,4,6],[22,16,16,20,16,40,22,4,2,2,2,2,2,2,2.083333333333333,2,2,2,2,2,2,2,2,2],[24,34,32,42,42,26,34,34,38,46,48,48,46,60,64.58333333333334,38.77551020408163,42.85714285714285,40.81632653061224,46.93877551020408,30.61224489795918,28.57142857142857,28.57142857142857,28.57142857142857,24.48979591836735],[30.61224489795918,24.48979591836735,24.48979591836735,24.48979591836735,16,40,22,4,2,2,2,2,2,2,2.083333333333333,2,2,4,2,2,2,2,2,2],[28,18,10,10,4,14,26,26,28,30,34,28,26,28,8.333333333333332,16,46,44,42,34,42,46,50,54],[26,8,8,4,24,18,16,8,62,42,32,26,68,10,10.41666666666667,22,46,36,20,18,38,26,20,22],[26.53061224489796,26.53061224489796,16.3265306122449,16.3265306122449,6,18,34,32,36,32,34,32,34,36,27.08333333333333,24,48,46,44,40,46,48,52,54],[18,16,12,4,4,6,24,18,28,20,28,24,16,32,20.83333333333334,8,34,32,30,26,34,54,57.99999999999999,62],[52,18,8,4,16,34,4,6,22,14,30,22,10,6,4.166666666666666,6,2.040816326530612,2.040816326530612,2.040816326530612,2.040816326530612,87.75510204081633,73.46938775510205,67.3469387755102,69.38775510204081],[26.53061224489796,20.40816326530612,14.28571428571428,12.24489795918367,6,12,22,22,28,20,32,22,28,32,22.91666666666666,16,38,36,26,22,36,44,56.00000000000001,57.99999999999999],[42,34,38,38,50,42,42,42,36,38,44,52,60,60,56.25,57.99999999999999,38,48,50,48,46,46,52,54],[12,14,18,12,18,22,18,14,14,12,14,14,18,10,8.333333333333332,8,8,8,10,8,6,6,6,6],[51.02040816326531,51.02040816326531,51.02040816326531,53.06122448979592,66,56.00000000000001,56.00000000000001,57.99999999999999,52,56.00000000000001,57.99999999999999,62,62,62,62.5,62,50,56.00000000000001,56.00000000000001,60,54,56.00000000000001,56.00000000000001,60],[28,30,30,30,30,36,34,34,36,38,38,40,48,50,52.08333333333334,48,52,52,52,52,52,52,56.00000000000001,56.00000000000001],[12,14,16,16,14,16,12,12,14,14,14,12,14,14,10.41666666666667,8,8,10,10,10,8,8,8,8],[44.89795918367347,46.93877551020408,48.97959183673469,51.02040816326531,50,48,54,52,54,57.99999999999999,62,64,62,62,62.5,62,60,60,60,60,60,62,62,62],[94,94,94,94,96,98,96,96,66,76,84,88,88,88,87.5,90,84,74,74,76,76,78,82,80],[88,86,86,86,88,92,88,90,78,56.00000000000001,60,62,64,57.99999999999999,50,56.00000000000001,84,86,86,86,90,90,90,90],[91.83673469387756,91.83673469387756,91.83673469387756,91.83673469387756,94,96,94,92,68,82,84,86,88,88,83.33333333333334,84,78,78,76,76,76,78,80,80],[86,76,84,92,98,96,96,84,56.00000000000001,86,100,100,96,96,95.83333333333334,96,94,90,80,84,38,36,54,44],[46,24,28,34,28,42,44,34,16,16,16,26,14,12,10.41666666666667,10,12,10,10,18,10,8,10,18],[77.55102040816327,71.42857142857143,77.55102040816327,89.79591836734694,94,90,88,78,48,80,100,100,94,92,91.66666666666666,92,94,90,76,80,38,30,44,38],[94,96,96,96,98,82,92,100,86,88,92,92,94,94,93.75,92,22,60,60,46,28,28,34,36],[62,64,62,52,50,56.00000000000001,48,56.00000000000001,48,48,56.00000000000001,68,44,4,4.166666666666666,4,8,8,14,14,14,14,16,16],[91.83673469387756,93.87755102040816,95.91836734693877,95.91836734693877,94,82,92,98,76,80,86,90,92,94,93.75,94,30,60,60,56.00000000000001,32,34,38,42],[4,4,4,4,12,20,42,10,10,92,92,96,98,96,95.83333333333334,96,92,96,92,94,96,98,96,94],[12,30,36,36,12,4,6,4,2,2,6,6,4,6,12.5,18.36734693877551,16.3265306122449,38.77551020408163,6.122448979591836,16.3265306122449,12.24489795918367,10.20408163265306,30.61224489795918,14.28571428571428],[6.122448979591836,8.163265306122449,4.081632653061225,10.20408163265306,20,40,52,24,18,92,92,96,96,96,95.83333333333334,96,92,96,92,94,96,98,94,94],[8,8,8,8,4,4,4,4,4,20,22,16,12,12,12.5,12,10,22,30,52,84,84,86,84],[78,72,74,72,68,62,66,60,14,14,14,16,34,88,93.75,90,94,90,92,88,92,94,94,92],[4.081632653061225,4.081632653061225,4.081632653061225,4.081632653061225,4,4,4,4,4,24,28,20,12,10,10.41666666666667,12,18,30,44,54,84,84,82,82],[12,12,12,12,14,14,14,10,10,22,30,32,40,42,35.41666666666667,30,2,18,30,30,44,44,42,46],[14,14,14,10,8,10,6,6,6,6,6,10,12,10,6.25,8,8,8,10,10,8,8,8,8],[14.28571428571428,14.28571428571428,14.28571428571428,14.28571428571428,16,18,16,16,14,30,42,44,52,56.00000000000001,43.75,40,2,28,38,42,57.99999999999999,57.99999999999999,54,56.00000000000001],[2,2,2,2,2,2,2,2,2,10,36,38,44,42,20.83333333333334,16,2,4,12,16,44,28,28,34],[57.99999999999999,64,60,56.00000000000001,40,24,12,6,6,12,24,34,38,26,18.75,8,4,6,6,4,12,8,8,18],[2.040816326530612,2.040816326530612,2.040816326530612,2.040816326530612,2,2,2,2,2,14,34,38,38,38,27.08333333333333,20,2,4,16,18,38,34,32,36],[10,10,8,10,16,22,54,18,14,94,94,96,98,100,97.91666666666666,96,96,96,94,96,94,94,94,94],[24,26,32,52,26,4,8,6,6,2,4,6,4,2,4.166666666666666,12,6,18,18,38,8,4,18,18],[10.20408163265306,12.24489795918367,10.20408163265306,18.36734693877551,26,48,66,36,24,94,94,96,96,98,97.91666666666666,96,96,94,94,94,94,92,94,94],[22,22,24,28,28,24,22,12,20,18,34,34,30,36,39.58333333333333,40,40,42,44,40,32,38,30,76],[22,22,26,28,34,22,28,26,24,26,20,18,22,26,25,24,30,32,42,42,26,26,28,30],[30.61224489795918,30.61224489795918,36.73469387755102,40.81632653061224,34,34,32,10,26,24,50,52,52,50,58.33333333333334,60,56.00000000000001,56.00000000000001,46,52,50,48,38,84],[82,78,92,24,57.99999999999999,28,42,96,90,82,100,88,60,20,33.33333333333333,26,46,62,84,52,100,92,80,88],[76,80,94,24,80,32,38,98,92,84,100,84,28,8,8.333333333333332,8,66,76,86,56.00000000000001,96,96,88,80],[100,100,100,100,20,16,74,52,100,100,100,100,100,100,100,100,8,6,10,12,100,8,4,100],[20,18,24,24,6,14,16,16,30,32,36,36,86,100,100,100,98,100,100,100,100,100,100,100],[24,22,24,24,12,18,22,20,32,32,36,36,88,98,97.91666666666666,98,98,98,98,98,98,98,98,98],[81.63265306122449,87.75510204081633,93.87755102040816,93.87755102040816,50,62,66,72,90,90,90,94,74,78,83.33333333333334,84,66,80,80,72,66,70,68,64],[94,94,94,96,98,84,94,96,84,88,88,92,94,94,93.75,94,18,48,60,56.00000000000001,40,44,46,54],[80,88,78,76,57.99999999999999,66,48,50,64,50,78,88,74,10,8.333333333333332,6,14,14,16,18,16,16,14,18],[91.83673469387756,93.87755102040816,95.91836734693877,95.91836734693877,94,82,90,92,68,82,86,90,92,92,91.66666666666666,94,26,50,56.00000000000001,57.99999999999999,38,50,48,50],[20,22,22,22,44,52,48,32,20,28,40,38,70,66,64.58333333333334,46,52,50,44,42,42,52,57.99999999999999,60],[22,14,16,22,18,18,8,8,16,30,20,16,34,14,12.5,10,24,32,18,16,26,26,16,18],[32.6530612244898,38.77551020408163,32.6530612244898,32.6530612244898,46,56.00000000000001,54,44,20,30,42,40,72,70,64.58333333333334,50,52,50,50,46,46,54,60,60],[98,96,96,94,86,74,38,74,56.00000000000001,4,4,4,4,4,4.166666666666666,6,4,4,4,4,4,4,4,4],[82,70,56.00000000000001,60,86,94,94,94,96,98,94,94,94,98,91.66666666666666,81.63265306122449,89.79591836734694,59.18367346938776,95.91836734693877,89.79591836734694,91.83673469387756,93.87755102040816,53.06122448979592,83.67346938775511],[93.87755102040816,87.75510204081633,89.79591836734694,81.63265306122449,70,54,36,54,50,4,4,4,4,4,4.166666666666666,6,4,4,4,4,4,4,4,4],[98,100,100,100,46,54,92,100,96,98,98,100,100,98,97.91666666666666,98,42,76,86,92,70,78,90,94],[38,84,90,82,70,96,84,94,94,92,94,94,96,8,6.25,6,10,4,12,6,14,4,6,8],[97.95918367346938,97.95918367346938,97.95918367346938,100,50,52,86,98,96,98,98,100,100,98,97.91666666666666,98,42,76,86,88,68,74,90,92],[94,96,96,96,96,78,92,98,86,88,90,92,94,94,91.66666666666666,92,18,40,57.99999999999999,42,32,30,40,44],[57.99999999999999,60,60,52,50,56.00000000000001,44,56.00000000000001,48,48,57.99999999999999,66,44,8,8.333333333333332,4,10,8,14,10,8,10,12,12],[93.87755102040816,93.87755102040816,93.87755102040816,95.91836734693877,92,80,90,96,74,80,84,90,92,94,93.75,94,22,48,57.99999999999999,48,34,38,44,46],[98,98,98,98,98,86,98,100,94,94,94,96,94,94,91.66666666666666,92,28,54,60,54,52,56.00000000000001,60,66],[70,74,72,57.99999999999999,64,74,60,76,76,78,86,94,64,8,8.333333333333332,6,10,12,16,10,6,6,10,14],[95.91836734693877,95.91836734693877,95.91836734693877,95.91836734693877,94,84,96,98,92,92,92,92,94,94,91.66666666666666,94,28,57.99999999999999,68,64,54,60,62,70],[24,24,26,26,28,30,32,32,36,38,44,46,48,48,47.91666666666667,48,48,48,48,48,52,52,52,52],[12,14,16,16,12,16,12,12,12,14,14,14,14,14,10.41666666666667,6,6,8,8,8,6,6,6,6],[36.73469387755102,36.73469387755102,38.77551020408163,40.81632653061224,44,44,46,52,52,56.00000000000001,56.00000000000001,57.99999999999999,57.99999999999999,57.99999999999999,60.41666666666666,57.99999999999999,60,56.00000000000001,57.99999999999999,57.99999999999999,57.99999999999999,60,60,60],[24,26,26,28,30,32,32,32,36,40,44,46,48,48,47.91666666666667,48,36,46,48,48,52,52,52,52],[12,14,16,16,14,16,12,12,12,14,14,14,14,14,10.41666666666667,6,6,8,8,8,6,8,6,8],[36.73469387755102,38.77551020408163,44.89795918367347,44.89795918367347,46,46,50,52,54,56.00000000000001,56.00000000000001,56.00000000000001,57.99999999999999,57.99999999999999,60.41666666666666,56.00000000000001,54,56.00000000000001,57.99999999999999,57.99999999999999,57.99999999999999,60,60,60],[24,24,26,28,30,32,32,32,36,48,52,54,54,57.99999999999999,58.33333333333334,56.00000000000001,56.00000000000001,50,50,50,50,50,50,50],[16,14,16,16,10,16,12,12,12,14,14,14,14,14,8.333333333333332,8,8,8,8,8,8,6,8,8],[36.73469387755102,36.73469387755102,38.77551020408163,44.89795918367347,50,44,52,54,54,60,60,62,60,60,60.41666666666666,60,60,60,60,60,60,60,60,60],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2.083333333333333,2,4,10,10,10,14,12,14,16],[2,8,8,2,2.040816326530612,2.040816326530612,2.040816326530612,4.081632653061225,6.122448979591836,6.122448979591836,30.61224489795918,36.73469387755102,42.85714285714285,85.71428571428571,44.68085106382978,38.77551020408163,48.97959183673469,61.22448979591837,67.3469387755102,93.87755102040816,95.91836734693877,95.91836734693877,97.95918367346938,95.91836734693877],[4.081632653061225,2.040816326530612,2.040816326530612,4.081632653061225,2.040816326530612,6.122448979591836,2,2,2,2,2,2,2,2,2.083333333333333,4,6,14,20,20,26,20,20,26],[94,92,92,92,86,88,84,84,44,64,76,80,88,86,91.66666666666666,96,96,96,96,96,86,86,88,88],[88,84,80,74,82,76,76,80,54,40,42,46,50,46,31.25,34,64,64,64,46,60,57.99999999999999,54,52],[93.87755102040816,91.83673469387756,89.79591836734694,91.83673469387756,86,86,84,82,52,70,78,86,86,86,91.66666666666666,92,96,96,94,92,86,84,86,84]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Date<\/th>\n      <th>30 89 Past Due Loans To Total Loans Leases All Institutions<\/th>\n      <th>30 89 Past Due Loans To Total Loans Leases Assets Less Than 1 Billion<\/th>\n      <th>30 89 Past Due Loans To Total Loans Leases Assets Greater Than 1 Billion<\/th>\n      <th>Community Bank Leverage Ratio Cblr Election Count All Institutions<\/th>\n      <th>Community Bank Leverage Ratio Cblr Election Count Assets Less Than 1 Billion<\/th>\n      <th>Community Bank Leverage Ratio Cblr Election Count Assets Greater Than 1 Billion<\/th>\n      <th>Core Deposits To Total Liabilities All Institutions<\/th>\n      <th>Core Deposits To Total Liabilities Assets Less Than 1 Billion<\/th>\n      <th>Core Deposits To Total Liabilities Assets Greater Than 1 Billion<\/th>\n      <th>Cost Of Funding Earning Assets All Institutions<\/th>\n      <th>Cost Of Funding Earning Assets Assets Less Than 1 Billion<\/th>\n      <th>Cost Of Funding Earning Assets Assets Greater Than 1 Billion<\/th>\n      <th>Credit Loss Provision To Net Charge Offs All Institutions<\/th>\n      <th>Credit Loss Provision To Net Charge Offs Assets Less Than 1 Billion<\/th>\n      <th>Credit Loss Provision To Net Charge Offs Assets Greater Than 1 Billion<\/th>\n      <th>Earning Assets All Institutions<\/th>\n      <th>Earning Assets Assets Less Than 1 Billion<\/th>\n      <th>Earning Assets Assets Greater Than 1 Billion<\/th>\n      <th>Equity Capital All Institutions<\/th>\n      <th>Equity Capital Assets Less Than 1 Billion<\/th>\n      <th>Equity Capital Assets Greater Than 1 Billion<\/th>\n      <th>Equity Capital To Total Assets All Institutions<\/th>\n      <th>Equity Capital To Total Assets Assets Less Than 1 Billion<\/th>\n      <th>Equity Capital To Total Assets Assets Greater Than 1 Billion<\/th>\n      <th>Gross 1 4 Family Mortgages To Gross Assets All Institutions<\/th>\n      <th>Gross 1 4 Family Mortgages To Gross Assets Assets Less Than 1 Billion<\/th>\n      <th>Gross 1 4 Family Mortgages To Gross Assets Assets Greater Than 1 Billion<\/th>\n      <th>Gross Real Estate Assets To Gross Assets All Institutions<\/th>\n      <th>Gross Real Estate Assets To Gross Assets Assets Less Than 1 Billion<\/th>\n      <th>Gross Real Estate Assets To Gross Assets Assets Greater Than 1 Billion<\/th>\n      <th>Leverage Core Capital Ratio All Institutions<\/th>\n      <th>Leverage Core Capital Ratio Assets Less Than 1 Billion<\/th>\n      <th>Leverage Core Capital Ratio Assets Greater Than 1 Billion<\/th>\n      <th>Loss Allowance To Loans Leases All Institutions<\/th>\n      <th>Loss Allowance To Loans Leases Assets Less Than 1 Billion<\/th>\n      <th>Loss Allowance To Loans Leases Assets Greater Than 1 Billion<\/th>\n      <th>Net Charge Offs All Institutions<\/th>\n      <th>Net Charge Offs Assets Less Than 1 Billion<\/th>\n      <th>Net Charge Offs Assets Greater Than 1 Billion<\/th>\n      <th>Net Charge Offs To Loans Leases All Institutions<\/th>\n      <th>Net Charge Offs To Loans Leases Assets Less Than 1 Billion<\/th>\n      <th>Net Charge Offs To Loans Leases Assets Greater Than 1 Billion<\/th>\n      <th>Net Income Year To Date All Institutions<\/th>\n      <th>Net Income Year To Date Assets Less Than 1 Billion<\/th>\n      <th>Net Income Year To Date Assets Greater Than 1 Billion<\/th>\n      <th>Net Interest Income All Institutions<\/th>\n      <th>Net Interest Income Assets Less Than 1 Billion<\/th>\n      <th>Net Interest Income Assets Greater Than 1 Billion<\/th>\n      <th>Net Interest Margin All Institutions<\/th>\n      <th>Net Interest Margin Assets Less Than 1 Billion<\/th>\n      <th>Net Interest Margin Assets Greater Than 1 Billion<\/th>\n      <th>Net Loans Leases To Total Assets All Institutions<\/th>\n      <th>Net Loans Leases To Total Assets Assets Less Than 1 Billion<\/th>\n      <th>Net Loans Leases To Total Assets Assets Greater Than 1 Billion<\/th>\n      <th>Net Operating Income To Average Assets All Institutions<\/th>\n      <th>Net Operating Income To Average Assets Assets Less Than 1 Billion<\/th>\n      <th>Net Operating Income To Average Assets Assets Greater Than 1 Billion<\/th>\n      <th>Noncurrent Loans Leases To Total Loans Leases All Institutions<\/th>\n      <th>Noncurrent Loans Leases To Total Loans Leases Assets Less Than 1 Billion<\/th>\n      <th>Noncurrent Loans Leases To Total Loans Leases Assets Greater Than 1 Billion<\/th>\n      <th>Noninterest Expense To Average Assets All Institutions<\/th>\n      <th>Noninterest Expense To Average Assets Assets Less Than 1 Billion<\/th>\n      <th>Noninterest Expense To Average Assets Assets Greater Than 1 Billion<\/th>\n      <th>Noninterest Income All Institutions<\/th>\n      <th>Noninterest Income Assets Less Than 1 Billion<\/th>\n      <th>Noninterest Income Assets Greater Than 1 Billion<\/th>\n      <th>Noninterest Income To Average Assets All Institutions<\/th>\n      <th>Noninterest Income To Average Assets Assets Less Than 1 Billion<\/th>\n      <th>Noninterest Income To Average Assets Assets Greater Than 1 Billion<\/th>\n      <th>Nonperforming Assets To Total Assets All Institutions<\/th>\n      <th>Nonperforming Assets To Total Assets Assets Less Than 1 Billion<\/th>\n      <th>Nonperforming Assets To Total Assets Assets Greater Than 1 Billion<\/th>\n      <th>Other Real Estate Owned All Institutions<\/th>\n      <th>Other Real Estate Owned Assets Less Than 1 Billion<\/th>\n      <th>Other Real Estate Owned Assets Greater Than 1 Billion<\/th>\n      <th>Percent Of Institutions With Earning Gains All Institutions<\/th>\n      <th>Percent Of Institutions With Earning Gains Assets Less Than 1 Billion<\/th>\n      <th>Percent Of Institutions With Earning Gains Assets Greater Than 1 Billion<\/th>\n      <th>Percent Of Unprofitable Institutions All Institutions<\/th>\n      <th>Percent Of Unprofitable Institutions Assets Less Than 1 Billion<\/th>\n      <th>Percent Of Unprofitable Institutions Assets Greater Than 1 Billion<\/th>\n      <th>Pretax Return On Assets All Institutions<\/th>\n      <th>Pretax Return On Assets Assets Less Than 1 Billion<\/th>\n      <th>Pretax Return On Assets Assets Greater Than 1 Billion<\/th>\n      <th>Provisions For Credit Losses All Institutions<\/th>\n      <th>Provisions For Credit Losses Assets Less Than 1 Billion<\/th>\n      <th>Provisions For Credit Losses Assets Greater Than 1 Billion<\/th>\n      <th>Reserve Coverage Ratio All Institutions<\/th>\n      <th>Reserve Coverage Ratio Assets Less Than 1 Billion<\/th>\n      <th>Reserve Coverage Ratio Assets Greater Than 1 Billion<\/th>\n      <th>Retained Earnings To Average Equity All Institutions<\/th>\n      <th>Retained Earnings To Average Equity Assets Less Than 1 Billion<\/th>\n      <th>Retained Earnings To Average Equity Assets Greater Than 1 Billion<\/th>\n      <th>Return On Assets All Institutions<\/th>\n      <th>Return On Assets Assets Less Than 1 Billion<\/th>\n      <th>Return On Assets Assets Greater Than 1 Billion<\/th>\n      <th>Return On Equity All Institutions<\/th>\n      <th>Return On Equity Assets Less Than 1 Billion<\/th>\n      <th>Return On Equity Assets Greater Than 1 Billion<\/th>\n      <th>Total Assets All Institutions<\/th>\n      <th>Total Assets Assets Less Than 1 Billion<\/th>\n      <th>Total Assets Assets Greater Than 1 Billion<\/th>\n      <th>Total Deposits All Institutions<\/th>\n      <th>Total Deposits Assets Less Than 1 Billion<\/th>\n      <th>Total Deposits Assets Greater Than 1 Billion<\/th>\n      <th>Total Loans Leases All Institutions<\/th>\n      <th>Total Loans Leases Assets Less Than 1 Billion<\/th>\n      <th>Total Loans Leases Assets Greater Than 1 Billion<\/th>\n      <th>Total Risk Based Capital Non Cblr Electors All Institutions<\/th>\n      <th>Total Risk Based Capital Non Cblr Electors Assets Less Than 1 Billion<\/th>\n      <th>Total Risk Based Capital Non Cblr Electors Assets Greater Than 1 Billion<\/th>\n      <th>Yield On Earning Assets All Institutions<\/th>\n      <th>Yield On Earning Assets Assets Less Than 1 Billion<\/th>\n      <th>Yield On Earning Assets Assets Greater Than 1 Billion<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":10,"dom":"Bfrtip","columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":21,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":22,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":23,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":24,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":25,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":26,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":27,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":28,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":29,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":30,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":31,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":32,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":33,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":34,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":35,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":36,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":37,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":38,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":39,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":40,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":41,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":42,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":43,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":44,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":45,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":46,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":47,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":48,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":49,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":50,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":51,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":52,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":53,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":54,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":55,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":56,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":57,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":58,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":59,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":60,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":61,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":62,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":63,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":64,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":65,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":66,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":67,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":68,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":69,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":70,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":71,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":72,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":73,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":74,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":75,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":76,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":77,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":78,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":79,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":80,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":81,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":82,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":83,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":84,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":85,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":86,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":87,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":88,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":89,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":90,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":91,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":92,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":93,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":94,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":95,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":96,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":97,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":98,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":99,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":100,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":101,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":102,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":103,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":104,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":105,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":106,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":107,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":108,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":109,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":110,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":111,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":112,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":113,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":114,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":115,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Date","targets":1},{"name":"30 89 Past Due Loans To Total Loans Leases All Institutions","targets":2},{"name":"30 89 Past Due Loans To Total Loans Leases Assets Less Than 1 Billion","targets":3},{"name":"30 89 Past Due Loans To Total Loans Leases Assets Greater Than 1 Billion","targets":4},{"name":"Community Bank Leverage Ratio Cblr Election Count All Institutions","targets":5},{"name":"Community Bank Leverage Ratio Cblr Election Count Assets Less Than 1 Billion","targets":6},{"name":"Community Bank Leverage Ratio Cblr Election Count Assets Greater Than 1 Billion","targets":7},{"name":"Core Deposits To Total Liabilities All Institutions","targets":8},{"name":"Core Deposits To Total Liabilities Assets Less Than 1 Billion","targets":9},{"name":"Core Deposits To Total Liabilities Assets Greater Than 1 Billion","targets":10},{"name":"Cost Of Funding Earning Assets All Institutions","targets":11},{"name":"Cost Of Funding Earning Assets Assets Less Than 1 Billion","targets":12},{"name":"Cost Of Funding Earning Assets Assets Greater Than 1 Billion","targets":13},{"name":"Credit Loss Provision To Net Charge Offs All Institutions","targets":14},{"name":"Credit Loss Provision To Net Charge Offs Assets Less Than 1 Billion","targets":15},{"name":"Credit Loss Provision To Net Charge Offs Assets Greater Than 1 Billion","targets":16},{"name":"Earning Assets All Institutions","targets":17},{"name":"Earning Assets Assets Less Than 1 Billion","targets":18},{"name":"Earning Assets Assets Greater Than 1 Billion","targets":19},{"name":"Equity Capital All Institutions","targets":20},{"name":"Equity Capital Assets Less Than 1 Billion","targets":21},{"name":"Equity Capital Assets Greater Than 1 Billion","targets":22},{"name":"Equity Capital To Total Assets All Institutions","targets":23},{"name":"Equity Capital To Total Assets Assets Less Than 1 Billion","targets":24},{"name":"Equity Capital To Total Assets Assets Greater Than 1 Billion","targets":25},{"name":"Gross 1 4 Family Mortgages To Gross Assets All Institutions","targets":26},{"name":"Gross 1 4 Family Mortgages To Gross Assets Assets Less Than 1 Billion","targets":27},{"name":"Gross 1 4 Family Mortgages To Gross Assets Assets Greater Than 1 Billion","targets":28},{"name":"Gross Real Estate Assets To Gross Assets All Institutions","targets":29},{"name":"Gross Real Estate Assets To Gross Assets Assets Less Than 1 Billion","targets":30},{"name":"Gross Real Estate Assets To Gross Assets Assets Greater Than 1 Billion","targets":31},{"name":"Leverage Core Capital Ratio All Institutions","targets":32},{"name":"Leverage Core Capital Ratio Assets Less Than 1 Billion","targets":33},{"name":"Leverage Core Capital Ratio Assets Greater Than 1 Billion","targets":34},{"name":"Loss Allowance To Loans Leases All Institutions","targets":35},{"name":"Loss Allowance To Loans Leases Assets Less Than 1 Billion","targets":36},{"name":"Loss Allowance To Loans Leases Assets Greater Than 1 Billion","targets":37},{"name":"Net Charge Offs All Institutions","targets":38},{"name":"Net Charge Offs Assets Less Than 1 Billion","targets":39},{"name":"Net Charge Offs Assets Greater Than 1 Billion","targets":40},{"name":"Net Charge Offs To Loans Leases All Institutions","targets":41},{"name":"Net Charge Offs To Loans Leases Assets Less Than 1 Billion","targets":42},{"name":"Net Charge Offs To Loans Leases Assets Greater Than 1 Billion","targets":43},{"name":"Net Income Year To Date All Institutions","targets":44},{"name":"Net Income Year To Date Assets Less Than 1 Billion","targets":45},{"name":"Net Income Year To Date Assets Greater Than 1 Billion","targets":46},{"name":"Net Interest Income All Institutions","targets":47},{"name":"Net Interest Income Assets Less Than 1 Billion","targets":48},{"name":"Net Interest Income Assets Greater Than 1 Billion","targets":49},{"name":"Net Interest Margin All Institutions","targets":50},{"name":"Net Interest Margin Assets Less Than 1 Billion","targets":51},{"name":"Net Interest Margin Assets Greater Than 1 Billion","targets":52},{"name":"Net Loans Leases To Total Assets All Institutions","targets":53},{"name":"Net Loans Leases To Total Assets Assets Less Than 1 Billion","targets":54},{"name":"Net Loans Leases To Total Assets Assets Greater Than 1 Billion","targets":55},{"name":"Net Operating Income To Average Assets All Institutions","targets":56},{"name":"Net Operating Income To Average Assets Assets Less Than 1 Billion","targets":57},{"name":"Net Operating Income To Average Assets Assets Greater Than 1 Billion","targets":58},{"name":"Noncurrent Loans Leases To Total Loans Leases All Institutions","targets":59},{"name":"Noncurrent Loans Leases To Total Loans Leases Assets Less Than 1 Billion","targets":60},{"name":"Noncurrent Loans Leases To Total Loans Leases Assets Greater Than 1 Billion","targets":61},{"name":"Noninterest Expense To Average Assets All Institutions","targets":62},{"name":"Noninterest Expense To Average Assets Assets Less Than 1 Billion","targets":63},{"name":"Noninterest Expense To Average Assets Assets Greater Than 1 Billion","targets":64},{"name":"Noninterest Income All Institutions","targets":65},{"name":"Noninterest Income Assets Less Than 1 Billion","targets":66},{"name":"Noninterest Income Assets Greater Than 1 Billion","targets":67},{"name":"Noninterest Income To Average Assets All Institutions","targets":68},{"name":"Noninterest Income To Average Assets Assets Less Than 1 Billion","targets":69},{"name":"Noninterest Income To Average Assets Assets Greater Than 1 Billion","targets":70},{"name":"Nonperforming Assets To Total Assets All Institutions","targets":71},{"name":"Nonperforming Assets To Total Assets Assets Less Than 1 Billion","targets":72},{"name":"Nonperforming Assets To Total Assets Assets Greater Than 1 Billion","targets":73},{"name":"Other Real Estate Owned All Institutions","targets":74},{"name":"Other Real Estate Owned Assets Less Than 1 Billion","targets":75},{"name":"Other Real Estate Owned Assets Greater Than 1 Billion","targets":76},{"name":"Percent Of Institutions With Earning Gains All Institutions","targets":77},{"name":"Percent Of Institutions With Earning Gains Assets Less Than 1 Billion","targets":78},{"name":"Percent Of Institutions With Earning Gains Assets Greater Than 1 Billion","targets":79},{"name":"Percent Of Unprofitable Institutions All Institutions","targets":80},{"name":"Percent Of Unprofitable Institutions Assets Less Than 1 Billion","targets":81},{"name":"Percent Of Unprofitable Institutions Assets Greater Than 1 Billion","targets":82},{"name":"Pretax Return On Assets All Institutions","targets":83},{"name":"Pretax Return On Assets Assets Less Than 1 Billion","targets":84},{"name":"Pretax Return On Assets Assets Greater Than 1 Billion","targets":85},{"name":"Provisions For Credit Losses All Institutions","targets":86},{"name":"Provisions For Credit Losses Assets Less Than 1 Billion","targets":87},{"name":"Provisions For Credit Losses Assets Greater Than 1 Billion","targets":88},{"name":"Reserve Coverage Ratio All Institutions","targets":89},{"name":"Reserve Coverage Ratio Assets Less Than 1 Billion","targets":90},{"name":"Reserve Coverage Ratio Assets Greater Than 1 Billion","targets":91},{"name":"Retained Earnings To Average Equity All Institutions","targets":92},{"name":"Retained Earnings To Average Equity Assets Less Than 1 Billion","targets":93},{"name":"Retained Earnings To Average Equity Assets Greater Than 1 Billion","targets":94},{"name":"Return On Assets All Institutions","targets":95},{"name":"Return On Assets Assets Less Than 1 Billion","targets":96},{"name":"Return On Assets Assets Greater Than 1 Billion","targets":97},{"name":"Return On Equity All Institutions","targets":98},{"name":"Return On Equity Assets Less Than 1 Billion","targets":99},{"name":"Return On Equity Assets Greater Than 1 Billion","targets":100},{"name":"Total Assets All Institutions","targets":101},{"name":"Total Assets Assets Less Than 1 Billion","targets":102},{"name":"Total Assets Assets Greater Than 1 Billion","targets":103},{"name":"Total Deposits All Institutions","targets":104},{"name":"Total Deposits Assets Less Than 1 Billion","targets":105},{"name":"Total Deposits Assets Greater Than 1 Billion","targets":106},{"name":"Total Loans Leases All Institutions","targets":107},{"name":"Total Loans Leases Assets Less Than 1 Billion","targets":108},{"name":"Total Loans Leases Assets Greater Than 1 Billion","targets":109},{"name":"Total Risk Based Capital Non Cblr Electors All Institutions","targets":110},{"name":"Total Risk Based Capital Non Cblr Electors Assets Less Than 1 Billion","targets":111},{"name":"Total Risk Based Capital Non Cblr Electors Assets Greater Than 1 Billion","targets":112},{"name":"Yield On Earning Assets All Institutions","targets":113},{"name":"Yield On Earning Assets Assets Less Than 1 Billion","targets":114},{"name":"Yield On Earning Assets Assets Greater Than 1 Billion","targets":115}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render","options.columnDefs.17.render","options.columnDefs.18.render","options.columnDefs.19.render","options.columnDefs.20.render","options.columnDefs.21.render","options.columnDefs.22.render","options.columnDefs.23.render","options.columnDefs.24.render","options.columnDefs.25.render","options.columnDefs.26.render","options.columnDefs.27.render","options.columnDefs.28.render","options.columnDefs.29.render","options.columnDefs.30.render","options.columnDefs.31.render","options.columnDefs.32.render","options.columnDefs.33.render","options.columnDefs.34.render","options.columnDefs.35.render","options.columnDefs.36.render","options.columnDefs.37.render","options.columnDefs.38.render","options.columnDefs.39.render","options.columnDefs.40.render","options.columnDefs.41.render","options.columnDefs.42.render","options.columnDefs.43.render","options.columnDefs.44.render","options.columnDefs.45.render","options.columnDefs.46.render","options.columnDefs.47.render","options.columnDefs.48.render","options.columnDefs.49.render","options.columnDefs.50.render","options.columnDefs.51.render","options.columnDefs.52.render","options.columnDefs.53.render","options.columnDefs.54.render","options.columnDefs.55.render","options.columnDefs.56.render","options.columnDefs.57.render","options.columnDefs.58.render","options.columnDefs.59.render","options.columnDefs.60.render","options.columnDefs.61.render","options.columnDefs.62.render","options.columnDefs.63.render","options.columnDefs.64.render","options.columnDefs.65.render","options.columnDefs.66.render","options.columnDefs.67.render","options.columnDefs.68.render","options.columnDefs.69.render","options.columnDefs.70.render","options.columnDefs.71.render","options.columnDefs.72.render","options.columnDefs.73.render","options.columnDefs.74.render","options.columnDefs.75.render","options.columnDefs.76.render","options.columnDefs.77.render","options.columnDefs.78.render","options.columnDefs.79.render","options.columnDefs.80.render","options.columnDefs.81.render","options.columnDefs.82.render","options.columnDefs.83.render","options.columnDefs.84.render","options.columnDefs.85.render","options.columnDefs.86.render","options.columnDefs.87.render","options.columnDefs.88.render","options.columnDefs.89.render","options.columnDefs.90.render","options.columnDefs.91.render","options.columnDefs.92.render","options.columnDefs.93.render","options.columnDefs.94.render","options.columnDefs.95.render","options.columnDefs.96.render","options.columnDefs.97.render","options.columnDefs.98.render","options.columnDefs.99.render","options.columnDefs.100.render","options.columnDefs.101.render","options.columnDefs.102.render","options.columnDefs.103.render","options.columnDefs.104.render","options.columnDefs.105.render","options.columnDefs.106.render","options.columnDefs.107.render","options.columnDefs.108.render","options.columnDefs.109.render","options.columnDefs.110.render","options.columnDefs.111.render","options.columnDefs.112.render","options.columnDefs.113.render"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>This analysis provides a comprehensive view of Arizona’s banking sector performance relative to other states. The percentile rankings help identify areas of strength and weakness in Arizona’s banking industry over time.</p>
<p>Key observations: - Percentiles above 50 indicate above-median performance compared to other states - Percentiles below 50 indicate below-median performance - Trends over time show how Arizona’s relative performance has evolved - Category analysis helps identify broader patterns in profitability, capital strength, and asset quality</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>